# PUDDiT – Моделиране на база данни и Data Warehouse

Този документ описва Data Warehouse модела на базата данни за вътрешната дискусионна платформа **PUDDiT** за Пловдивския университет.

Използвани нотации: 
- **Data Warehouse модел** – *UML database notation* (star schema)  

Диаграмата е реализирана с **draw.io / diagrams.net**.

## 3. Data Warehouse модел (Star Schema, UML notation)

Data Warehouse моделът е изграден като **звездна схема (Star Schema)** и служи за аналитична обработка на данните от оперативната база на PUDDiT.  
Моделът е реализиран чрез **UML database notation**, в който измеренията (dimensions) са представени като класове с атрибути, а факт таблиците (facts) – като класове с числови метрики и външни ключове към измеренията.

### 3.1. Измерения (Dimensions)

DW съдържа **шест измерения**, които описват ключовите аналитични контексти:

#### DimDate  
Съдържа календарни атрибути за всяка дата. Използва се за анализ по ден, месец, година, седмица, ден от седмицата и др.

#### DimUser  
Съдържа данни за потребителите на платформата – имена, имейли, факултетни номера, роли. Използва се за анализ на активността на автори, коментиращи и гласуващи.

#### DimChannel  
Описва каналите в платформата – име, описание, дали е частен. Позволява анализ на активността по тематични канали.

#### DimPost  
Съдържа метаданни за постовете – заглавия, кой ги е създал, в кой канал са публикувани. Използва се за свързване на фактите към конкретен пост.

#### DimStatus  
Описва всички възможни статуси в системата (Active, Hidden, Locked, Open, Resolved, Rejected). Използва се за анализ на жизнения цикъл на постове и коментари.

#### DimVoteType  
Представя типовете гласове – Upvote (+1) и Downvote (-1). Използва се за разделяне на гласовете по тип в аналитичните визуализации.

---

### 3.2. Факт таблици (Facts)

В модела присъстват **три факт таблици**, агрегирани на дневно ниво:

#### FactPostDaily  
**Grain:** 1 ред = *1 пост за 1 дата*

Съдържа метрики за дневна активност върху постове:

- брой нови постове,  
- брой коментари,  
- брой гласове,  
- score на поста (+1/-1),  
- брой доклади,  
- статус на поста за съответната дата.  

Свързана е с DimDate, DimPost, DimUser, DimChannel и DimStatus.

---

#### FactCommentDaily  
**Grain:** 1 ред = *всички коментари към конкретен пост за определена дата*

Метрики:

- брой нови коментари,  
- гласове за коментари,  
- score,  
- доклади,  
- статуси на коментарите.  

Свързана е с DimDate, DimPost, DimUser и DimStatus.

---

#### FactVoteDaily  
**Grain:** 1 ред = *агрегирани гласове за дадена дата, канал и тип глас*

Метрики:

- брой гласове по VoteType (Upvote/Downvote).  

Свързана е с DimDate, DimChannel и DimVoteType.  
Това позволява анализ на общата „пулсация“ на гласуването в каналите, без да се влиза в детайлно ниво per post.

---

### 3.3. Предимства на модела за Power BI и аналитични отчети

Моделът е оптимизиран за **OLAP анализ**, като позволява:

- агрегиране на активност по дати, седмици, месеци и години,  
- измерване на активността по потребители, роли и канали,  
- анализ на поведението на постове (гласове, score, доклади),  
- сравняване на активности между различни канали,  
- откриване на най-активните потребители и постове,  
- изготвяне на heatmaps на часови/дневни пикове,  
- филтриране на визуализации по всички измерения едновременно (date, channel, post, user, status, vote type).

---

## 4. Инсталация и стартиране

1. Създайте база данни `PUDDiT` в MS SQL Server.  
2. Изпълнете скрипта `schema.sql`, за да създадете структурата на базата (таблици, ключове, функция, процедура и trigger).  
3. Изпълнете `seed.sql`, за да напълните базата с примерни данни (потребители, канали, постове, коментари, гласове и доклади).  
4. За аналитичната част (Data Warehouse) може да се създаде отделна база/схема, в която да се реализират таблиците Dim/Fact и да се заредят чрез ETL процес от OLTP базата, или да използвате вече готовият в папката BONUS
